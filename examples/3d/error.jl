# generator code

using LinearAlgebraicRepresentation
using Plasm, SparseArrays
Lar = LinearAlgebraicRepresentation
L = LinearAlgebraicRepresentation

function twocubes()
    #V,(VV,EV,FV,CV) = Lar.cuboid([0.5,0.5,0.5],true,[-0.5,-0.5,-0.5])
    V,(VV,EV,FV,CV) = Lar.cuboidGrid([2,2,2],true)
    mybox = (V,CV,FV,EV)

    twocubes = Lar.Struct([mybox, L.t(0.3,0.4,0.5), L.r(pi/5,0,0), L.r(0,0,pi/12), mybox])
    #twocubes = Lar.Struct([mybox, L.t(0.3,0.4,0.5), L.r(pi/3,0,0), L.r(0,0,pi/6), mybox])
    V,CV,FV,EV = Lar.struct2lar(twocubes)
    Plasm.view(V,CV)

    cop_EV = Lar.coboundary_0(EV::Lar.Cells);
    cop_EW = convert(Lar.ChainOp, cop_EV);
    cop_FE = Lar.coboundary_1(V, FV::Lar.Cells, EV::Lar.Cells);
    W = convert(Lar.Points, V');

    V, copEV, copFE, copCF = Lar.Arrangement.spatial_arrangement( W, cop_EW, cop_FE)
    EV = Lar.cop2lar(copEV)
    FE = [findnz(copFE[k,:])[1] for k=1:size(copFE,1)]
    FV = [collect(Set(cat(EV[e] for e in FE[f]))) for f=1:length(FE)]
    FV = convert(Lar.Cells, FV)
    W = convert(Lar.Points, V')

    Plasm.view(Plasm.numbering(0.25)((W,[[[k] for k=1:size(W,2)],EV,FV])))

    triangulated_faces = Lar.triangulate(V, [copEV, copFE])
    FVs = convert(Array{Lar.Cells}, triangulated_faces)
    V = convert(Lar.Points, V')
    Plasm.viewcolor(V::Lar.Points, FVs::Array{Lar.Cells})

    EVs = Lar.FV2EVs(copEV, copFE) # polygonal face fragments
    model = V,EVs
    Plasm.view(Plasm.lar_exploded(model)(1.2,1.2,1.2))
end

twocubes()


# wrong intermediate output (before the TGW algorithm loops)

rV = 
[0.0 0.0 0.0; 0.0 0.0 1.0; 0.0 1.0 0.0; 0.0 1.0 1.0; 0.0 0.0 2.0; 0.0 1.0 2.0; 0.0 1.0 1.57897; 0.0 0.694107 2.0; 0.0 0.763271 2.0; 0.0 0.718003 1.96711; 0.0 2.0 0.0; 0.0 2.0 1.0; 0.0 2.0 2.0; 0.0 2.0 1.66247; 0.0 2.0 1.68366; 0.0 1.77017 2.0; 0.0 1.30579 1.15809; 1.0 0.0 0.0; 1.0 0.0 1.0; 1.0 1.0 0.0; 1.0 1.0 1.0; 1.0 1.0 0.935926; 1.0 0.268571 1.0; 1.0 0.551743 0.610248; 1.0 0.0 2.0; 1.0 0.0 1.44545; 1.0 0.0 1.36966; 1.0 1.0 2.0; 1.0 1.0 1.75459; 1.0 1.0 1.80295; 1.0 0.763271 2.0; 1.0 0.8217 2.0; 1.0 0.856838 2.0; 1.0 2.0 0.0; 1.0 2.0 1.0; 1.0 1.08819 1.0; 1.0 2.0 2.0; 1.0 2.0 1.66247; 1.0 1.3893 1.21877; 1.0 1.4123 1.23548; 2.0 0.0 0.0; 2.0 0.0 1.0; 2.0 1.0 0.0; 2.0 1.0 1.0; 2.0 1.0 0.935926; 2.0 0.599775 1.0; 2.0 0.768518 0.767744; 2.0 0.0 2.0; 2.0 0.0 1.82552; 2.0 1.0 2.0; 2.0 0.763271 2.0; 2.0 0.180733 1.57676; 2.0 2.0 0.0; 2.0 2.0 1.0; 2.0 1.08819 1.0; 2.0 2.0 2.0; 2.0 1.01957 2.0; 2.0 1.51881 1.31286; 0.150465 0.0 2.0; 0.3 0.0 1.05055; 0.237805 0.0 1.44545; 0.0911865 1.0 1.0; 0.101278 1.0 0.935926; 0.968966 1.0 2.0; 0.041181 1.0 1.3175; 0.693928 2.0 2.0; 0.752191 2.0 2.0; 0.805351 2.0 1.66247; 1.18574 0.0 2.0; 1.16627 0.0 1.44545; 1.26593 0.0 1.49088; 1.12646 1.0 1.0; 1.13655 1.0 0.935926; 1.53834 1.0 2.0; 1.00711 1.0 1.75783; 1.78747 2.0 2.0; 1.84063 2.0 1.66247; 0.3 0.0367287 1.0; 0.823585 0.763271 2.0; 0.041181 0.504136 2.0; 0.0720689 1.08819 1.0; 1.26593 0.356647 1.0; 1.02028 0.763271 2.0; 1.00711 0.824054 2.0; 1.10734 1.08819 1.0; 1.97303 1.14397 2.0; 0.3 0.4 0.5; 0.3 -0.187785 1.30902; 0.041181 1.18145 1.06776; 0.041181 0.593665 1.87677; 0.3 -0.775571 2.11803; 0.041181 0.0058799 2.68579; -0.217638 1.9629 1.63551; -0.217638 1.37512 2.44453; -0.217638 0.78733 3.25355; 1.26593 0.609389 0.65213; 1.26593 0.0216038 1.46115; 1.00711 1.39084 1.21989; 1.00711 0.803054 2.0289; 1.26593 -0.566182 2.27016; 1.00711 0.215269 2.83792; 0.748288 2.17229 1.78764; 0.748288 1.5845 2.59666; 0.748288 0.996719 3.40568; 2.23185 0.818778 0.80426; 2.23185 0.230993 1.61328; 1.97303 1.60023 1.37202; 1.97303 1.01244 2.18103; 2.23185 -0.356793 2.42229; 1.97303 0.424658 2.99005; 1.71421 2.38168 1.93977; 1.71421 1.79389 2.74879; 1.71421 1.20611 3.55781] 



rcopEV = [[1,1,-1],[3,1,-1],[86,1,-1],[1,2,1],[4,2,-1],[5,2,-1],[87,2,-1],[2,3,-1],[3,3,1],[15,3,-1],[94,3,-1],[2,4,1],[4,4,1],[6,4,-1],[16,4,-1],[95,4,-1],[5,5,1],[8,5,-1],[88,5,-1],[7,6,-1],[10,6,-1],[20,6,-1],[99,6,-1],[6,7,1],[7,7,1],[11,7,-1],[23,7,-1],[103,7,-1],[8,8,1],[9,8,-1],[13,8,-1],[149,8,-1],[9,9,1],[10,9,1],[12,9,-1],[147,9,-1],[11,10,1],[12,10,1],[13,10,1],[187,10,-1],[188,10,-1],[14,11,-1],[15,11,1],[105,11,-1],[14,12,1],[16,12,1],[17,12,-1],[106,12,-1],[19,13,-1],[21,13,-1],[107,13,-1],[17,14,1],[18,14,-1],[22,14,-1],[110,14,-1],[18,15,1],[19,15,1],[24,15,-1],[113,15,-1],[20,16,1],[21,16,1],[24,16,1],[153,16,-1],[22,17,1],[23,17,1],[185,17,-1],[186,17,-1],[25,18,-1],[28,18,-1],[86,18,1],[114,18,-1],[25,19,1],[29,19,-1],[33,19,-1],[87,19,1],[115,19,-1],[26,20,-1],[28,20,1],[48,20,-1],[94,20,1],[123,20,-1],[27,21,-1],[30,21,-1],[36,21,-1],[49,21,-1],[96,21,-1],[124,21,-1],[26,22,1],[27,22,1],[31,22,-1],[51,22,-1],[97,22,-1],[126,22,-1],[29,23,1],[30,23,1],[32,23,-1],[43,23,-1],[141,23,-1],[154,23,-1],[31,24,1],[32,24,1],[227,24,-1],[228,24,-1],[35,25,-1],[39,25,-1],[89,25,-1],[116,25,-1],[34,26,-1],[35,26,1],[46,26,-1],[92,26,-1],[119,26,-1],[33,27,1],[34,27,1],[43,27,1],[90,27,-1],[118,27,-1],[38,28,-1],[42,28,-1],[54,28,-1],[100,28,-1],[129,28,-1],[36,29,1],[37,29,-1],[44,29,-1],[57,29,-1],[102,29,-1],[132,29,-1],[37,30,1],[38,30,1],[45,30,-1],[59,30,-1],[104,30,-1],[134,30,-1],[39,31,1],[40,31,-1],[46,31,1],[145,31,-1],[161,31,-1],[40,32,1],[41,32,-1],[44,32,1],[143,32,-1],[158,32,-1],[41,33,1],[42,33,1],[45,33,1],[144,33,-1],[160,33,-1],[47,34,-1],[48,34,1],[105,34,1],[135,34,-1],[47,35,1],[50,35,-1],[52,35,-1],[106,35,1],[136,35,-1],[49,36,1],[50,36,1],[51,36,1],[55,36,-1],[150,36,-1],[164,36,-1],[53,37,-1],[54,37,1],[109,37,-1],[137,37,-1],[52,38,1],[53,38,1],[58,38,-1],[111,38,-1],[139,38,-1],[55,39,1],[56,39,-1],[57,39,1],[232,39,-1],[233,39,-1],[56,40,1],[58,40,1],[59,40,1],[206,40,-1],[207,40,-1],[60,41,-1],[63,41,-1],[114,41,1],[60,42,1],[64,42,-1],[68,42,-1],[115,42,1],[61,43,-1],[63,43,1],[77,43,-1],[123,43,1],[62,44,-1],[65,44,-1],[70,44,-1],[78,44,-1],[125,44,-1],[61,45,1],[62,45,1],[66,45,-1],[80,45,-1],[127,45,-1],[64,46,1],[65,46,1],[67,46,-1],[73,46,-1],[155,46,-1],[66,47,1],[67,47,1],[240,47,-1],[241,47,-1],[69,48,-1],[71,48,-1],[117,48,-1],[68,49,1],[69,49,1],[75,49,-1],[121,49,-1],[70,50,1],[72,50,-1],[82,50,-1],[130,50,-1],[71,51,1],[72,51,1],[74,51,-1],[162,51,-1],[73,52,1],[74,52,1],[75,52,1],[242,52,-1],[243,52,-1],[76,53,-1],[77,53,1],[135,53,1],[76,54,1],[79,54,-1],[81,54,-1],[136,54,1],[78,55,1],[79,55,1],[80,55,1],[84,55,-1],[165,55,-1],[81,56,1],[83,56,-1],[138,56,-1],[82,57,1],[83,57,1],[85,57,-1],[167,57,-1],[84,58,1],[85,58,1],[215,58,-1],[216,58,-1],[88,59,1],[89,59,1],[93,59,-1],[146,59,-1],[90,60,1],[91,60,-1],[171,60,-1],[172,60,-1],[91,61,1],[92,61,1],[93,61,1],[178,61,-1],[179,61,-1],[95,62,1],[96,62,1],[98,62,-1],[101,62,-1],[142,62,-1],[151,62,-1],[97,63,1],[98,63,1],[175,63,-1],[176,63,-1],[99,64,1],[100,64,1],[104,64,1],[144,64,1],[152,64,-1],[101,65,1],[102,65,1],[103,65,1],[173,65,-1],[174,65,-1],[107,66,1],[108,66,-1],[113,66,1],[153,66,1],[108,67,1],[109,67,1],[112,67,-1],[152,67,1],[110,68,1],[111,68,1],[112,68,1],[207,68,1],[208,68,-1],[116,69,1],[117,69,1],[122,69,-1],[163,69,-1],[118,70,1],[119,70,1],[120,70,-1],[229,70,-1],[230,70,-1],[120,71,1],[121,71,1],[122,71,1],[201,71,-1],[202,71,-1],[124,72,1],[125,72,1],[128,72,-1],[131,72,-1],[156,72,-1],[166,72,-1],[126,73,1],[127,73,1],[128,73,1],[196,73,-1],[197,73,-1],[129,74,1],[130,74,1],[133,74,-1],[159,74,-1],[168,74,-1],[131,75,1],[132,75,1],[133,75,1],[134,75,1],[193,75,-1],[194,75,-1],[137,76,1],[138,76,1],[140,76,-1],[169,76,-1],[139,77,1],[140,77,1],[222,77,-1],[223,77,-1],[141,78,1],[142,78,1],[170,78,-1],[171,78,1],[143,79,1],[145,79,1],[147,79,1],[148,79,-1],[234,79,-1],[235,79,-1],[146,80,1],[148,80,1],[149,80,1],[181,80,-1],[182,80,-1],[150,81,1],[151,81,1],[176,81,1],[177,81,-1],[154,82,1],[155,82,1],[156,82,1],[191,82,-1],[192,82,-1],[157,83,-1],[161,83,1],[162,83,1],[163,83,1],[199,83,-1],[200,83,-1],[157,84,1],[158,84,1],[159,84,1],[160,84,1],[194,84,1],[195,84,-1],[164,85,1],[165,85,1],[166,85,1],[197,85,1],[198,85,-1],[167,86,1],[168,86,1],[169,86,1],[213,86,-1],[214,86,-1],[170,87,1],[175,87,1],[227,87,1],[172,88,1],[178,88,1],[180,88,-1],[229,88,1],[173,89,1],[177,89,1],[185,89,1],[232,89,1],[174,90,1],[179,90,1],[181,90,1],[187,90,1],[234,90,1],[180,91,1],[183,91,-1],[231,91,-1],[182,92,1],[183,92,1],[190,92,-1],[236,92,-1],[184,93,-1],[186,93,1],[237,93,-1],[184,94,1],[188,94,1],[189,94,-1],[238,94,-1],[189,95,1],[190,95,1],[239,95,-1],[191,96,1],[196,96,1],[228,96,1],[240,96,1],[192,97,1],[199,97,1],[201,97,1],[230,97,1],[242,97,1],[193,98,1],[198,98,1],[206,98,1],[233,98,1],[245,98,-1],[195,99,1],[200,99,1],[203,99,-1],[209,99,-1],[235,99,1],[246,99,-1],[202,100,1],[204,100,-1],[231,100,1],[244,100,-1],[203,101,1],[204,101,1],[211,101,-1],[236,101,1],[247,101,-1],[205,102,-1],[208,102,1],[237,102,1],[248,102,-1],[205,103,1],[209,103,1],[210,103,-1],[238,103,1],[249,103,-1],[210,104,1],[211,104,1],[239,104,1],[250,104,-1],[212,105,-1],[215,105,1],[241,105,1],[212,106,1],[217,106,-1],[218,106,-1],[243,106,1],[213,107,1],[216,107,1],[222,107,1],[245,107,1],[214,108,1],[217,108,1],[219,108,-1],[224,108,-1],[246,108,1],[218,109,1],[220,109,-1],[244,109,1],[219,110,1],[220,110,1],[226,110,-1],[247,110,1],[221,111,-1],[223,111,1],[248,111,1],[221,112,1],[224,112,1],[225,112,-1],[249,112,1],[225,113,1],[226,113,1],[250,113,1]]



rcopFE = [[1,1,1],[31,1,1],[1,2,-1],[5,2,1],[35,2,1],[1,3,-1],[61,3,1],[1,4,1],[2,4,1],[62,4,1],[2,5,-1],[32,5,-1],[2,6,1],[6,6,1],[37,6,-1],[3,7,-1],[8,7,-1],[39,7,1],[2,8,-1],[64,8,1],[4,9,-1],[65,9,1],[3,10,1],[66,10,-1],[2,11,1],[3,11,-1],[101,11,-1],[102,11,1],[3,12,1],[4,12,-1],[166,12,-1],[167,12,1],[2,13,-1],[4,13,1],[103,13,1],[104,13,-1],[5,14,-1],[41,14,1],[5,15,-1],[70,15,-1],[5,16,1],[6,16,-1],[72,16,-1],[6,17,-1],[43,17,-1],[8,18,-1],[42,18,-1],[7,19,1],[44,19,1],[8,20,1],[73,20,-1],[7,21,-1],[74,21,1],[6,22,-1],[8,22,1],[163,22,-1],[165,22,1],[6,23,1],[8,23,-1],[100,23,1],[102,23,-1],[7,24,1],[8,24,-1],[138,24,-1],[139,24,1],[9,25,1],[31,25,-1],[46,25,1],[9,26,-1],[16,26,1],[35,26,-1],[51,26,1],[10,27,1],[17,27,-1],[36,27,1],[52,27,-1],[9,28,-1],[61,28,-1],[76,28,1],[9,29,1],[13,29,1],[62,29,-1],[77,29,1],[10,30,-1],[11,30,-1],[63,30,1],[78,30,-1],[9,31,-1],[10,31,1],[152,31,1],[156,31,-1],[9,32,1],[10,32,-1],[124,32,1],[128,32,-1],[13,33,-1],[32,33,1],[47,33,1],[11,34,1],[33,34,-1],[48,34,-1],[14,35,1],[34,35,-1],[49,35,-1],[11,36,1],[18,36,1],[38,36,1],[54,36,1],[12,37,1],[19,37,1],[39,37,1],[55,37,1],[15,38,-1],[20,38,-1],[40,38,-1],[56,38,-1],[14,39,-1],[68,39,-1],[80,39,1],[11,40,-1],[67,40,-1],[81,40,1],[12,41,-1],[66,41,-1],[82,41,1],[15,42,1],[69,42,1],[83,42,-1],[11,43,-1],[13,43,1],[125,43,-1],[126,43,1],[11,44,1],[12,44,-1],[132,44,-1],[133,44,1],[12,45,1],[15,45,-1],[113,45,-1],[115,45,1],[11,46,-1],[14,46,1],[159,46,1],[160,46,-1],[16,47,-1],[41,47,-1],[58,47,1],[16,48,-1],[70,48,1],[86,48,1],[17,49,1],[18,49,-1],[71,49,1],[87,49,1],[16,50,-1],[21,50,1],[72,50,-1],[88,50,-1],[16,51,1],[17,51,-1],[153,51,-1],[154,51,1],[21,52,-1],[43,52,1],[59,52,1],[20,53,1],[45,53,-1],[60,53,-1],[20,54,1],[75,54,1],[90,54,1],[18,55,-1],[21,55,1],[155,55,-1],[157,55,1],[19,56,-1],[21,56,1],[164,56,-1],[165,56,1],[18,57,1],[19,57,-1],[131,57,1],[134,57,-1],[20,58,1],[21,58,-1],[176,58,-1],[177,58,1],[19,59,1],[20,59,-1],[112,59,1],[114,59,-1],[22,60,1],[46,60,-1],[22,61,-1],[27,61,1],[51,61,-1],[23,62,1],[28,62,-1],[53,62,1],[22,63,-1],[76,63,-1],[22,64,1],[24,64,1],[77,64,-1],[23,65,-1],[25,65,-1],[79,65,1],[22,66,-1],[23,66,1],[169,66,1],[172,66,-1],[22,67,1],[23,67,-1],[141,67,1],[143,67,-1],[24,68,-1],[47,68,-1],[26,69,1],[50,69,1],[25,70,1],[29,70,1],[57,70,-1],[26,71,-1],[85,71,-1],[25,72,1],[84,72,1],[24,73,1],[25,73,-1],[142,73,-1],[143,73,1],[25,74,1],[26,74,-1],[173,74,1],[174,74,-1],[24,75,-1],[26,75,1],[144,75,1],[145,75,-1],[27,76,-1],[58,76,-1],[27,77,-1],[86,77,-1],[28,78,1],[29,78,-1],[89,78,-1],[27,79,-1],[30,79,1],[88,79,1],[27,80,1],[28,80,-1],[170,80,-1],[172,80,1],[30,81,-1],[59,81,-1],[29,82,1],[92,82,-1],[30,83,-1],[91,83,1],[29,84,-1],[30,84,1],[171,84,-1],[172,84,1],[29,85,1],[30,85,-1],[118,85,1],[119,85,-1],[31,86,-1],[61,86,-1],[31,87,1],[32,87,1],[62,87,-1],[32,88,-1],[64,88,-1],[34,89,1],[68,89,1],[32,90,1],[33,90,-1],[125,90,-1],[127,90,1],[32,91,1],[33,91,-1],[94,91,1],[96,91,-1],[33,92,1],[34,92,-1],[158,92,-1],[160,92,1],[32,93,-1],[34,93,1],[98,93,-1],[99,93,1],[35,94,-1],[61,94,1],[70,94,1],[35,95,1],[37,95,1],[62,95,1],[72,95,1],[36,96,-1],[38,96,-1],[63,96,-1],[71,96,-1],[35,97,-1],[36,97,1],[152,97,-1],[153,97,1],[35,98,1],[36,98,-1],[93,98,1],[97,98,-1],[39,99,-1],[66,99,1],[73,99,1],[40,100,1],[69,100,-1],[75,100,-1],[37,101,1],[38,101,-1],[94,101,-1],[95,101,1],[38,102,1],[39,102,-1],[131,102,-1],[132,102,1],[37,103,-1],[39,103,1],[100,103,-1],[101,103,1],[39,104,1],[40,104,-1],[114,104,1],[115,104,-1],[41,105,-1],[70,105,-1],[41,106,1],[43,106,1],[72,106,-1],[44,107,-1],[74,107,-1],[42,108,-1],[73,108,-1],[45,109,1],[75,109,1],[42,110,1],[43,110,-1],[163,110,1],[165,110,-1],[43,111,1],[45,111,-1],[177,111,-1],[178,111,1],[42,112,-1],[45,112,1],[114,112,1],[116,112,-1],[42,113,-1],[44,113,1],[138,113,1],[139,113,-1],[46,114,-1],[76,114,-1],[46,115,1],[47,115,-1],[77,115,-1],[49,116,1],[80,116,-1],[50,117,-1],[85,117,1],[47,118,1],[48,118,-1],[126,118,1],[127,118,-1],[48,119,1],[49,119,-1],[158,119,1],[159,119,-1],[47,120,1],[49,120,-1],[129,120,-1],[130,120,1],[47,121,-1],[50,121,1],[144,121,-1],[145,121,1],[49,122,1],[50,122,-1],[110,122,-1],[111,122,1],[51,123,-1],[76,123,1],[86,123,-1],[52,124,1],[54,124,-1],[78,124,1],[87,124,-1],[53,125,-1],[57,125,1],[79,125,-1],[89,125,1],[51,126,1],[52,126,-1],[154,126,-1],[156,126,1],[51,127,-1],[53,127,1],[169,127,-1],[170,127,1],[52,128,1],[53,128,-1],[105,128,1],[109,128,-1],[56,129,1],[83,129,1],[90,129,-1],[57,130,-1],[84,130,-1],[92,130,1],[54,131,-1],[57,131,1],[106,131,1],[108,131,-1],[54,132,1],[55,132,-1],[133,132,-1],[134,132,1],[56,133,1],[57,133,-1],[146,133,-1],[147,133,1],[55,134,1],[56,134,-1],[112,134,-1],[113,134,1],[58,135,-1],[86,135,1],[58,136,1],[59,136,-1],[88,136,1],[60,137,1],[90,137,1],[59,138,-1],[91,138,-1],[59,139,1],[60,139,-1],[176,139,1],[178,139,-1],[59,140,-1],[60,140,1],[121,140,1],[122,140,-1],[62,141,-1],[63,141,1],[124,141,-1],[125,141,1],[62,142,1],[63,142,-1],[93,142,-1],[94,142,1],[66,143,1],[67,143,-1],[132,143,-1],[135,143,1],[66,144,-1],[69,144,1],[115,144,1],[116,144,-1],[67,145,1],[68,145,-1],[160,145,-1],[161,145,1],[64,146,-1],[68,146,1],[98,146,1],[99,146,-1],[65,147,1],[66,147,-1],[166,147,1],[167,147,-1],[65,148,1],[68,148,-1],[136,148,-1],[137,148,1],[64,149,1],[65,149,-1],[103,149,-1],[104,149,1],[71,150,1],[72,150,-1],[153,150,-1],[155,150,1],[71,151,-1],[72,151,1],[95,151,-1],[97,151,1],[73,152,1],[75,152,-1],[114,152,1],[116,152,-1],[73,153,-1],[74,153,1],[138,153,-1],[139,153,1],[77,154,1],[78,154,-1],[126,154,-1],[128,154,1],[77,155,-1],[79,155,1],[141,155,-1],[142,155,1],[78,156,1],[79,156,-1],[105,156,-1],[108,156,1],[81,157,-1],[84,157,1],[107,157,-1],[108,157,1],[81,158,1],[82,158,-1],[133,158,1],[135,158,-1],[83,159,1],[84,159,-1],[147,159,-1],[148,159,1],[82,160,1],[83,160,-1],[113,160,-1],[116,160,1],[80,161,1],[81,161,-1],[159,161,1],[161,161,-1],[84,162,1],[85,162,-1],[173,162,-1],[174,162,1],[80,163,-1],[85,163,1],[110,163,1],[111,163,-1],[87,164,1],[88,164,-1],[154,164,1],[157,164,-1],[88,165,1],[89,165,-1],[170,165,-1],[171,165,1],[87,166,-1],[89,166,1],[106,166,-1],[109,166,1],[91,167,1],[92,167,-1],[118,167,-1],[119,167,1],[90,168,-1],[92,168,1],[146,168,1],[148,168,-1],[90,169,1],[91,169,-1],[121,169,-1],[122,169,1],[93,170,-1],[124,170,-1],[94,171,-1],[125,171,-1],[96,172,1],[127,172,1],[95,173,1],[100,173,-1],[131,173,-1],[94,174,-1],[101,174,1],[132,174,1],[93,175,1],[152,175,-1],[97,176,-1],[153,176,1],[95,177,-1],[155,177,1],[96,178,-1],[98,178,-1],[158,178,-1],[94,179,1],[99,179,1],[160,179,1],[98,180,-1],[130,180,-1],[99,181,-1],[103,181,-1],[137,181,1],[98,182,1],[104,182,1],[136,182,-1],[98,183,-1],[162,183,1],[102,184,-1],[138,184,1],[100,185,1],[165,185,1],[102,186,-1],[163,186,-1],[101,187,-1],[103,187,1],[167,187,1],[102,188,1],[104,188,-1],[166,188,-1],[104,189,-1],[140,189,-1],[104,190,1],[168,190,-1],[105,191,-1],[128,191,1],[141,191,-1],[108,192,1],[126,192,-1],[142,192,1],[106,193,1],[112,193,-1],[134,193,1],[146,193,-1],[108,194,-1],[113,194,1],[133,194,-1],[147,194,1],[107,195,-1],[116,195,1],[135,195,-1],[148,195,1],[105,196,1],[156,196,1],[169,196,-1],[109,197,-1],[154,197,-1],[170,197,1],[106,198,-1],[157,198,-1],[171,198,1],[108,199,-1],[111,199,-1],[159,199,1],[173,199,-1],[107,200,1],[110,200,1],[161,200,-1],[174,200,1],[111,201,1],[129,201,-1],[144,201,-1],[110,202,-1],[130,202,1],[145,202,1],[110,203,1],[117,203,1],[136,203,1],[149,203,1],[110,204,-1],[162,204,-1],[175,204,1],[116,205,-1],[138,205,-1],[150,205,1],[112,206,1],[164,206,-1],[176,206,-1],[114,207,-1],[165,207,1],[177,207,1],[116,208,-1],[163,208,1],[178,208,1],[116,209,1],[117,209,-1],[166,209,1],[179,209,1],[117,210,-1],[140,210,1],[151,210,1],[117,211,1],[168,211,1],[180,211,1],[118,212,1],[143,212,-1],[119,213,1],[121,213,-1],[146,213,1],[118,214,-1],[122,214,1],[148,214,-1],[118,215,1],[172,215,1],[119,216,-1],[171,216,-1],[118,217,1],[120,217,1],[174,217,-1],[120,218,-1],[145,218,-1],[120,219,1],[123,219,1],[149,219,-1],[120,220,-1],[175,220,-1],[122,221,-1],[150,221,-1],[121,222,1],[176,222,1],[122,223,-1],[178,223,-1],[122,224,1],[123,224,-1],[179,224,-1],[123,225,-1],[151,225,-1],[123,226,1],[180,226,-1],[124,227,1],[152,227,1],[128,228,-1],[156,228,-1],[127,229,-1],[130,229,-1],[158,229,1],[126,230,1],[129,230,1],[159,230,-1],[130,231,-1],[162,231,-1],[131,232,1],[155,232,-1],[165,232,-1],[134,233,-1],[157,233,1],[164,233,1],[132,234,-1],[137,234,-1],[160,234,-1],[167,234,-1],[135,235,1],[136,235,1],[161,235,1],[166,235,1],[136,236,-1],[162,236,1],[168,236,1],[138,237,-1],[163,237,-1],[138,238,1],[140,238,1],[166,238,-1],[140,239,-1],[168,239,-1],[141,240,1],[169,240,1],[143,241,-1],[172,241,-1],[142,242,-1],[144,242,1],[173,242,1],[143,243,1],[145,243,-1],[174,243,-1],[145,244,1],[175,244,-1],[146,245,-1],[171,245,1],[176,245,-1],[148,246,1],[149,246,-1],[174,246,1],[179,246,-1],[149,247,1],[175,247,1],[180,247,-1],[150,248,-1],[178,248,1],[150,249,1],[151,249,-1],[179,249,1],[151,250,1],[180,250,1]]

V = convert(Lar.Points, rV');
copEV = sort(rcopEV);
copFE = sort(rcopFE);
EV = hcat(copEV...);
FE = hcat(copFE...);
ev = sparse(EV[1,:], EV[2,:], EV[3,:]);
fe = sparse(FE[1,:], FE[2,:], FE[3,:]);
EV = [findnz(ev[k,:])[1] for k=1:size(ev,1)];
FE = [findnz(fe[k,:])[1] for k=1:size(fe,1)];
FV = convert(Lar.Cells,[collect(Set(cat([EV[e] for e in f]))) for f in FE]);

Plasm.view(V,FV)



