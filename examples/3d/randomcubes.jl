using LinearAlgebraicRepresentation
using Plasm
Lar = LinearAlgebraicRepresentation

store = []
scaling = 0.75
V,(VV,EV,FV,CV) = Lar.cuboid([0.25,0.25,0.25],true,[-0.25,-0.25,-0.25])
mybox = (V,CV,FV,EV)
for k=1:20
	size = rand()*scaling
	scale = Lar.s(size,size,size)
	transl = Lar.t(rand(3)...)
	alpha = 2*pi*rand()
	rx = Lar.r(alpha,0,0); ry = Lar.r(0,alpha,0); rz = Lar.r(0,0,alpha)
	rot = rx * ry * rz
	s = Lar.Struct([ transl, scale, rot, mybox ])
	push!(store, Lar.struct2lar(s))
end

s = Lar.Struct(store)
V,CV,FV,EV = Lar.struct2lar(s)
# V = Plasm.normalize3D(V) TODO:  solve MethodError bug
Plasm.view(V,CV)

cop_EV = Lar.coboundary_0(EV::Lar.Cells);
cop_EW = convert(Lar.ChainOp, cop_EV);
cop_FE = Lar.coboundary_1(V, FV::Lar.Cells, EV::Lar.Cells);
W = convert(Lar.Points, V');

@show W;
@show findnz(cop_EW);
@show findnz(cop_FE);

W = [0.83592 0.61088 0.846444; 1.0149 0.703705 0.902749; 0.928744 0.536342 0.674255; 1.10773 0.629167 0.730559; 0.892224 0.438691 0.951335; 1.07121 0.531515 1.00764; 0.985048 0.364153 0.779145; 1.16403 0.456977 0.83545; 0.712261 0.73647 0.339979; 0.573106 0.668021 0.378651; 0.643812 0.880627 0.348833; 0.504657 0.812178 0.387504; 0.750933 0.745324 0.494805; 0.611777 0.676875 0.533477; 0.682484 0.889481 0.503659; 0.543328 0.821032 0.54233; -0.0182384 0.402138 0.322676; 0.0210201 0.364316 0.458649; -0.0560609 0.535292 0.370634; -0.0168024 0.49747 0.506608; 0.117735 0.450097 0.296757; 0.156994 0.412274 0.432731; 0.0799127 0.583251 0.344716; 0.119171 0.545428 0.480689; 0.593636 -0.0197304 0.120056; 0.640406 0.0258916 0.322072; 0.639258 0.180016 0.0643839; 0.686029 0.225638 0.2664; 0.795652 -0.0754024 0.0858575; 0.842423 -0.0297803 0.287874; 0.841274 0.124344 0.0301856; 0.888045 0.169966 0.232202; 0.820112 0.0932612 0.232001; 0.64302 0.0152897 0.270236; 0.74214 0.274259 0.239965; 0.565048 0.196287 0.278201; 0.858347 0.101225 0.425334; 0.681256 0.023254 0.463569; 0.780376 0.282223 0.433298; 0.603284 0.204251 0.471534; 0.201649 0.116998 0.771224; 0.0977425 0.175757 0.811513; 0.260408 0.227965 0.760927; 0.156502 0.286724 0.801216; 0.241938 0.106701 0.89015; 0.138031 0.16546 0.930438; 0.300697 0.217668 0.879852; 0.19679 0.276427 0.920141; 0.574342 0.904726 0.340976; 0.568141 0.910803 0.370901; 0.58042 0.934897 0.336109; 0.574218 0.940974 0.366034; 0.604267 0.899858 0.348166; 0.598066 0.905936 0.378091; 0.610345 0.930029 0.343299; 0.604143 0.936106 0.373223; 0.893288 0.0762128 0.684644; 0.969605 0.119498 0.714453; 0.936573 0.0542539 0.60571; 1.01289 0.097539 0.635518; 0.923096 -0.0027219 0.722949; 0.999414 0.0405633 0.752757; 0.966381 -0.0246808 0.644014; 1.0427 0.0186043 0.673823; 0.367223 0.0990947 0.276288; 0.239565 0.0264833 0.326504; 0.294612 0.235667 0.289179; 0.166954 0.163055 0.339394; 0.417438 0.111985 0.422585; 0.289781 0.0393734 0.472801; 0.344827 0.248557 0.435476; 0.217169 0.175946 0.485691; -0.0002101 -0.0663546 0.332657; -0.0480699 -0.0189766 0.664; 0.0471679 0.265948 0.291985; -0.0006919 0.313326 0.623328; 0.331133 -0.107026 0.386332; 0.283274 -0.0596483 0.717675; 0.378511 0.225276 0.34566; 0.330651 0.272654 0.677004; 0.91432 0.820545 0.912723; 0.913823 0.821031 0.914914; 0.914806 0.822759 0.912342; 0.914309 0.823245 0.914533; 0.916512 0.820165 0.913304; 0.916014 0.82065 0.915496; 0.916997 0.822379 0.912924; 0.9165 0.822864 0.915115; 0.173102 0.478659 0.66564; 0.166183 0.471742 1.03868; 0.166184 0.851697 0.67243; 0.159266 0.84478 1.04547; 0.546138 0.485448 0.672685; 0.539219 0.478531 1.04572; 0.53922 0.858487 0.679474; 0.532302 0.851569 1.05251; 0.466073 0.80916 0.652094; 0.570579 0.906827 0.90862; 0.56374 1.05246 0.519675; 0.668246 1.15012 0.776201; 0.722599 0.676741 0.598003; 0.827106 0.774408 0.854529; 0.820266 0.920037 0.465585; 0.924773 1.0177 0.722111; 0.819439 0.221664 0.906514; 0.83246 0.210136 0.928462; 0.807911 0.240798 0.923402; 0.820932 0.22927 0.945351; 0.841388 0.238553 0.902362; 0.854409 0.227025 0.924311; 0.82986 0.257686 0.919251; 0.842881 0.246158 0.941199; 0.421325 0.345062 0.429813; 0.591683 0.433972 0.484212; 0.510235 0.275506 0.265063; 0.680593 0.364416 0.319461; 0.475724 0.180312 0.528726; 0.646081 0.269222 0.583125; 0.564634 0.110756 0.363976; 0.734991 0.199666 0.418375; 0.247394 0.630295 0.184609; 0.471649 0.476363 0.329906; 0.0934624 0.657 0.450482; 0.317717 0.503068 0.595779; 0.392692 0.896168 0.242027; 0.616946 0.742236 0.387325; 0.23876 0.922872 0.5079; 0.463014 0.76894 0.653197; 0.722834 0.819011 0.507666; 0.860195 0.813688 0.507873; 0.717511 0.682063 0.518309; 0.854871 0.67674 0.518515; 0.723041 0.829654 0.644717; 0.860401 0.82433 0.644923; 0.717718 0.692706 0.65536; 0.855078 0.687383 0.655566; 0.951537 0.245262 0.372937; 0.841836 0.311369 0.422855; 1.01764 0.365045 0.359586; 0.907943 0.431152 0.409504; 1.00146 0.231911 0.50032; 0.891754 0.298018 0.550238; 1.06756 0.351694 0.486968; 0.957861 0.417801 0.536887; 0.0642638 0.656373 0.213373; 0.0573622 0.64963 0.244313; 0.0575205 0.687625 0.218681; 0.0506189 0.680882 0.24962; 0.0952034 0.66168 0.221432; 0.0883018 0.654937 0.252371; 0.0884601 0.692933 0.226739; 0.0815585 0.686189 0.257678; -0.0164233 0.783604 0.0535589; 0.0132813 0.754596 0.185078; -0.0454307 0.913744 0.088814; -0.0157261 0.884737 0.220333; 0.115095 0.818859 0.0316301; 0.1448 0.789851 0.163149; 0.0860879 0.948999 0.0668852; 0.115793 0.919992 0.198404]

cop_EW = sparse([1, 5, 9, 1, 6, 10, 2, 5, 11, 2, 6, 12, 3, 7, 9, 3, 8, 10, 4, 7, 11, 4, 8, 12, 13, 17, 21, 13, 18, 22, 14, 17, 23, 14, 18, 24, 15, 19, 21, 15, 20, 22, 16, 19, 23, 16, 20, 24, 25, 29, 33, 25, 30, 34, 26, 29, 35, 26, 30, 36, 27, 31, 33, 27, 32, 34, 28, 31, 35, 28, 32, 36, 37, 41, 45, 37, 42, 46, 38, 41, 47, 38, 42, 48, 39, 43, 45, 39, 44, 46, 40, 43, 47, 40, 44, 48, 49, 53, 57, 49, 54, 58, 50, 53, 59, 50, 54, 60, 51, 55, 57, 51, 56, 58, 52, 55, 59, 52, 56, 60, 61, 65, 69, 61, 66, 70, 62, 65, 71, 62, 66, 72, 63, 67, 69, 63, 68, 70, 64, 67, 71, 64, 68, 72, 73, 77, 81, 73, 78, 82, 74, 77, 83, 74, 78, 84, 75, 79, 81, 75, 80, 82, 76, 79, 83, 76, 80, 84, 85, 89, 93, 85, 90, 94, 86, 89, 95, 86, 90, 96, 87, 91, 93, 87, 92, 94, 88, 91, 95, 88, 92, 96, 97, 101, 105, 97, 102, 106, 98, 101, 107, 98, 102, 108, 99, 103, 105, 99, 104, 106, 100, 103, 107, 100, 104, 108, 109, 113, 117, 109, 114, 118, 110, 113, 119, 110, 114, 120, 111, 115, 117, 111, 116, 118, 112, 115, 119, 112, 116, 120, 121, 125, 129, 121, 126, 130, 122, 125, 131, 122, 126, 132, 123, 127, 129, 123, 128, 130, 124, 127, 131, 124, 128, 132, 133, 137, 141, 133, 138, 142, 134, 137, 143, 134, 138, 144, 135, 139, 141, 135, 140, 142, 136, 139, 143, 136, 140, 144, 145, 149, 153, 145, 150, 154, 146, 149, 155, 146, 150, 156, 147, 151, 153, 147, 152, 154, 148, 151, 155, 148, 152, 156, 157, 161, 165, 157, 162, 166, 158, 161, 167, 158, 162, 168, 159, 163, 165, 159, 164, 166, 160, 163, 167, 160, 164, 168, 169, 173, 177, 169, 174, 178, 170, 173, 179, 170, 174, 180, 171, 175, 177, 171, 176, 178, 172, 175, 179, 172, 176, 180, 181, 185, 189, 181, 186, 190, 182, 185, 191, 182, 186, 192, 183, 187, 189, 183, 188, 190, 184, 187, 191, 184, 188, 192, 193, 197, 201, 193, 198, 202, 194, 197, 203, 194, 198, 204, 195, 199, 201, 195, 200, 202, 196, 199, 203, 196, 200, 204, 205, 209, 213, 205, 210, 214, 206, 209, 215, 206, 210, 216, 207, 211, 213, 207, 212, 214, 208, 211, 215, 208, 212, 216, 217, 221, 225, 217, 222, 226, 218, 221, 227, 218, 222, 228, 219, 223, 225, 219, 224, 226, 220, 223, 227, 220, 224, 228, 229, 233, 237, 229, 234, 238, 230, 233, 239, 230, 234, 240, 231, 235, 237, 231, 236, 238, 232, 235, 239, 232, 236, 240], [1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10, 10, 10, 11, 11, 11, 12, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19, 19, 19, 20, 20, 20, 21, 21, 21, 22, 22, 22, 23, 23, 23, 24, 24, 24, 25, 25, 25, 26, 26, 26, 27, 27, 27, 28, 28, 28, 29, 29, 29, 30, 30, 30, 31, 31, 31, 32, 32, 32, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38, 38, 39, 39, 39, 40, 40, 40, 41, 41, 41, 42, 42, 42, 43, 43, 43, 44, 44, 44, 45, 45, 45, 46, 46, 46, 47, 47, 47, 48, 48, 48, 49, 49, 49, 50, 50, 50, 51, 51, 51, 52, 52, 52, 53, 53, 53, 54, 54, 54, 55, 55, 55, 56, 56, 56, 57, 57, 57, 58, 58, 58, 59, 59, 59, 60, 60, 60, 61, 61, 61, 62, 62, 62, 63, 63, 63, 64, 64, 64, 65, 65, 65, 66, 66, 66, 67, 67, 67, 68, 68, 68, 69, 69, 69, 70, 70, 70, 71, 71, 71, 72, 72, 72, 73, 73, 73, 74, 74, 74, 75, 75, 75, 76, 76, 76, 77, 77, 77, 78, 78, 78, 79, 79, 79, 80, 80, 80, 81, 81, 81, 82, 82, 82, 83, 83, 83, 84, 84, 84, 85, 85, 85, 86, 86, 86, 87, 87, 87, 88, 88, 88, 89, 89, 89, 90, 90, 90, 91, 91, 91, 92, 92, 92, 93, 93, 93, 94, 94, 94, 95, 95, 95, 96, 96, 96, 97, 97, 97, 98, 98, 98, 99, 99, 99, 100, 100, 100, 101, 101, 101, 102, 102, 102, 103, 103, 103, 104, 104, 104, 105, 105, 105, 106, 106, 106, 107, 107, 107, 108, 108, 108, 109, 109, 109, 110, 110, 110, 111, 111, 111, 112, 112, 112, 113, 113, 113, 114, 114, 114, 115, 115, 115, 116, 116, 116, 117, 117, 117, 118, 118, 118, 119, 119, 119, 120, 120, 120, 121, 121, 121, 122, 122, 122, 123, 123, 123, 124, 124, 124, 125, 125, 125, 126, 126, 126, 127, 127, 127, 128, 128, 128, 129, 129, 129, 130, 130, 130, 131, 131, 131, 132, 132, 132, 133, 133, 133, 134, 134, 134, 135, 135, 135, 136, 136, 136, 137, 137, 137, 138, 138, 138, 139, 139, 139, 140, 140, 140, 141, 141, 141, 142, 142, 142, 143, 143, 143, 144, 144, 144, 145, 145, 145, 146, 146, 146, 147, 147, 147, 148, 148, 148, 149, 149, 149, 150, 150, 150, 151, 151, 151, 152, 152, 152, 153, 153, 153, 154, 154, 154, 155, 155, 155, 156, 156, 156, 157, 157, 157, 158, 158, 158, 159, 159, 159, 160, 160, 160], Int8[-1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1, -1, -1, -1, 1, -1, -1, -1, 1, -1, 1, 1, -1, -1, -1, 1, 1, -1, 1, -1, 1, 1, 1, 1, 1])

cop_FE = sparse([1, 3, 1, 4, 2, 3, 2, 4, 1, 5, 1, 6, 2, 5, 2, 6, 3, 5, 3, 6, 4, 5, 4, 6, 7, 9, 7, 10, 8, 9, 8, 10, 7, 11, 7, 12, 8, 11, 8, 12, 9, 11, 9, 12, 10, 11, 10, 12, 13, 15, 13, 16, 14, 15, 14, 16, 13, 17, 13, 18, 14, 17, 14, 18, 15, 17, 15, 18, 16, 17, 16, 18, 19, 21, 19, 22, 20, 21, 20, 22, 19, 23, 19, 24, 20, 23, 20, 24, 21, 23, 21, 24, 22, 23, 22, 24, 25, 27, 25, 28, 26, 27, 26, 28, 25, 29, 25, 30, 26, 29, 26, 30, 27, 29, 27, 30, 28, 29, 28, 30, 31, 33, 31, 34, 32, 33, 32, 34, 31, 35, 31, 36, 32, 35, 32, 36, 33, 35, 33, 36, 34, 35, 34, 36, 37, 39, 37, 40, 38, 39, 38, 40, 37, 41, 37, 42, 38, 41, 38, 42, 39, 41, 39, 42, 40, 41, 40, 42, 43, 45, 43, 46, 44, 45, 44, 46, 43, 47, 43, 48, 44, 47, 44, 48, 45, 47, 45, 48, 46, 47, 46, 48, 49, 51, 49, 52, 50, 51, 50, 52, 49, 53, 49, 54, 50, 53, 50, 54, 51, 53, 51, 54, 52, 53, 52, 54, 55, 57, 55, 58, 56, 57, 56, 58, 55, 59, 55, 60, 56, 59, 56, 60, 57, 59, 57, 60, 58, 59, 58, 60, 61, 63, 61, 64, 62, 63, 62, 64, 61, 65, 61, 66, 62, 65, 62, 66, 63, 65, 63, 66, 64, 65, 64, 66, 67, 69, 67, 70, 68, 69, 68, 70, 67, 71, 67, 72, 68, 71, 68, 72, 69, 71, 69, 72, 70, 71, 70, 72, 73, 75, 73, 76, 74, 75, 74, 76, 73, 77, 73, 78, 74, 77, 74, 78, 75, 77, 75, 78, 76, 77, 76, 78, 79, 81, 79, 82, 80, 81, 80, 82, 79, 83, 79, 84, 80, 83, 80, 84, 81, 83, 81, 84, 82, 83, 82, 84, 85, 87, 85, 88, 86, 87, 86, 88, 85, 89, 85, 90, 86, 89, 86, 90, 87, 89, 87, 90, 88, 89, 88, 90, 91, 93, 91, 94, 92, 93, 92, 94, 91, 95, 91, 96, 92, 95, 92, 96, 93, 95, 93, 96, 94, 95, 94, 96, 97, 99, 97, 100, 98, 99, 98, 100, 97, 101, 97, 102, 98, 101, 98, 102, 99, 101, 99, 102, 100, 101, 100, 102, 103, 105, 103, 106, 104, 105, 104, 106, 103, 107, 103, 108, 104, 107, 104, 108, 105, 107, 105, 108, 106, 107, 106, 108, 109, 111, 109, 112, 110, 111, 110, 112, 109, 113, 109, 114, 110, 113, 110, 114, 111, 113, 111, 114, 112, 113, 112, 114, 115, 117, 115, 118, 116, 117, 116, 118, 115, 119, 115, 120, 116, 119, 116, 120, 117, 119, 117, 120, 118, 119, 118, 120], [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 14, 14, 15, 15, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 30, 30, 31, 31, 32, 32, 33, 33, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 39, 39, 40, 40, 41, 41, 42, 42, 43, 43, 44, 44, 45, 45, 46, 46, 47, 47, 48, 48, 49, 49, 50, 50, 51, 51, 52, 52, 53, 53, 54, 54, 55, 55, 56, 56, 57, 57, 58, 58, 59, 59, 60, 60, 61, 61, 62, 62, 63, 63, 64, 64, 65, 65, 66, 66, 67, 67, 68, 68, 69, 69, 70, 70, 71, 71, 72, 72, 73, 73, 74, 74, 75, 75, 76, 76, 77, 77, 78, 78, 79, 79, 80, 80, 81, 81, 82, 82, 83, 83, 84, 84, 85, 85, 86, 86, 87, 87, 88, 88, 89, 89, 90, 90, 91, 91, 92, 92, 93, 93, 94, 94, 95, 95, 96, 96, 97, 97, 98, 98, 99, 99, 100, 100, 101, 101, 102, 102, 103, 103, 104, 104, 105, 105, 106, 106, 107, 107, 108, 108, 109, 109, 110, 110, 111, 111, 112, 112, 113, 113, 114, 114, 115, 115, 116, 116, 117, 117, 118, 118, 119, 119, 120, 120, 121, 121, 122, 122, 123, 123, 124, 124, 125, 125, 126, 126, 127, 127, 128, 128, 129, 129, 130, 130, 131, 131, 132, 132, 133, 133, 134, 134, 135, 135, 136, 136, 137, 137, 138, 138, 139, 139, 140, 140, 141, 141, 142, 142, 143, 143, 144, 144, 145, 145, 146, 146, 147, 147, 148, 148, 149, 149, 150, 150, 151, 151, 152, 152, 153, 153, 154, 154, 155, 155, 156, 156, 157, 157, 158, 158, 159, 159, 160, 160, 161, 161, 162, 162, 163, 163, 164, 164, 165, 165, 166, 166, 167, 167, 168, 168, 169, 169, 170, 170, 171, 171, 172, 172, 173, 173, 174, 174, 175, 175, 176, 176, 177, 177, 178, 178, 179, 179, 180, 180, 181, 181, 182, 182, 183, 183, 184, 184, 185, 185, 186, 186, 187, 187, 188, 188, 189, 189, 190, 190, 191, 191, 192, 192, 193, 193, 194, 194, 195, 195, 196, 196, 197, 197, 198, 198, 199, 199, 200, 200, 201, 201, 202, 202, 203, 203, 204, 204, 205, 205, 206, 206, 207, 207, 208, 208, 209, 209, 210, 210, 211, 211, 212, 212, 213, 213, 214, 214, 215, 215, 216, 216, 217, 217, 218, 218, 219, 219, 220, 220, 221, 221, 222, 222, 223, 223, 224, 224, 225, 225, 226, 226, 227, 227, 228, 228, 229, 229, 230, 230, 231, 231, 232, 232, 233, 233, 234, 234, 235, 235, 236, 236, 237, 237, 238, 238, 239, 239, 240, 240], Int8[1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, 1, -1, -1, 1, 1, 1])

V, copEV, copFE, copCF = Lar.Arrangement.spatial_arrangement(
	W::Lar.Points, cop_EW::Lar.ChainOp, cop_FE::Lar.ChainOp)



triangulated_faces = Lar.triangulate2D(V, [copEV, copFE])
FVs = convert(Array{Lar.Cells}, triangulated_faces)
V = convert(Lar.Points, V')
Plasm.viewcolor(V::Lar.Points, FVs::Array{Lar.Cells})

EVs = Lar.FV2EVs(copEV, copFE) # polygonal face fragments
model = V,EVs
Plasm.view(Plasm.lar_exploded(model)(1.2,1.2,1.2))
