using LinearAlgebraicRepresentation
Lar = LinearAlgebraicRepresentation
using SparseArrays;
using ViewerGL, LinearAlgebra
GL = ViewerGL

V = [0.5872165 0.3971089 0.7513519 0.5612443 0.8680828 0.6779753 1.0322182 0.8421107 0.6899599 0.502989 0.8326865 0.6457156 0.8586244 0.6716535 1.001351 0.8143801 0.7034275 0.5062553 0.5414431 0.3442709 0.9368317 0.7396595 0.7748473 0.5776751 0.5361978 0.3644763 0.5783999 0.4066785 0.5468975 0.375176 0.5890997 0.4173782; 0.7362077 0.9003431 1.0654701 1.2296055 0.6548871 0.8190224 0.9841495 1.1482849 0.2417823 0.3845089 0.4884655 0.6311921 0.1912528 0.3339794 0.4379359 0.5806626 0.2712775 0.1092931 0.5687776 0.4067931 0.3409058 0.1789214 0.6384059 0.4764215 0.2867544 0.3289566 0.4588041 0.5010062 0.2854601 0.3276623 0.4575098 0.4997119; 0.5347294 0.8155957 0.4534087 0.7342751 0.7723598 1.0532262 0.6910392 0.9719055 0.0757586 0.2444231 0.0252291 0.1938936 0.3054883 0.4741529 0.2549588 0.4236233 0.6584519 0.8918561 0.7280803 0.9614845 0.9039468 1.137351 0.9735751 1.2069793 0.1554979 0.1661976 0.1542036 0.1649033 0.3323244 0.3430241 0.3310301 0.3417298]

CV = Array{Int64,1}[[1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15, 16], [17, 18, 19, 20, 21, 22, 23, 24], [25, 26, 27, 28, 29, 30, 31, 32]]

FV = Array{Int64,1}[[1, 2, 3, 4], [5, 6, 7, 8], [1, 2, 5, 6], [3, 4, 7, 8], [1, 3, 5, 7], [2, 4, 6, 8], [9, 10, 11, 12], [13, 14, 15, 16], [9, 10, 13, 14], [11, 12, 15, 16], [9, 11, 13, 15], [10, 12, 14, 16], [17, 18, 19, 20], [21, 22, 23, 24], [17, 18, 21, 22], [19, 20, 23, 24], [17, 19, 21, 23], [18, 20, 22, 24], [25, 26, 27, 28], [29, 30, 31, 32], [25, 26, 29, 30], [27, 28, 31, 32], [25, 27, 29, 31], [26, 28, 30, 32]]

EV = Array{Int64,1}[[1, 2], [3, 4], [5, 6], [7, 8], [1, 3], [2, 4], [5, 7], [6, 8], [1, 5], [2, 6], [3, 7], [4, 8], [9, 10], [11, 12], [13, 14], [15, 16], [9, 11], [10, 12], [13, 15], [14, 16], [9, 13], [10, 14], [11, 15], [12, 16], [17, 18], [19, 20], [21, 22], [23, 24], [17, 19], [18, 20], [21, 23], [22, 24], [17, 21], [18, 22], [19, 23], [20, 24], [25, 26], [27, 28], [29, 30], [31, 32], [25, 27], [26, 28], [29, 31], [30, 32], [25, 29], [26, 30], [27, 31], [28, 32]]

GL.VIEW([ GL.GLPol(V,CV, GL.COLORS[1]) ]);
cop_EV = Lar.coboundary_0(EV::Lar.Cells);
cop_FE = Lar.coboundary_1(V, FV::Lar.Cells, EV::Lar.Cells);
W = convert(Lar.Points, V');#cobordo 1
V, copEV, copFE, copCF = Lar.Arrangement.spatial_arrangement(W::Lar.Points, cop_EV::Lar.ChainOp, cop_FE::Lar.ChainOp);
triangulated_faces = Lar.triangulate2D(V, [copEV, copFE]);
FVs = convert(Array{Lar.Cells}, triangulated_faces);
VVV = convert(Lar.Points, V');
GL.VIEW( GL.GLExplode(VVV,FVs,1,1,1,99,1) );
EVs = Lar.FV2EVs(copEV, copFE); # polygonal face fragments
GL.VIEW( GL.GLExplode(VVV,EVs,1.5,1.5,1.5,99,1) );
